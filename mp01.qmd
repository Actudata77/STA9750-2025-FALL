---
title: "Mini Project 01"
author: "Hyacinthe Sarr"
date: "`r format(Sys.Date(), '%B %d, %Y')`"
format:
  html:
    code-fold: true
    code-summary: "Show technical details"
---

## Introduction

In this report, we will take a close look at Netflix’s global Top 10 viewership dataset. Our ultimate goal is to uncover key insights into user engagement with the platform's films and TV shows, evaluate patterns and highlights opportunities for growth.
In the first part of the report, by using some some Explanatory Data Analysis questions, I uncover some answers about targeted questions on Netflix most popular domestic and international programs. Those findings are then translated in press releases in the second part of report.

Some key facts:

- Netflix operates in more than 90 countries
- Most of Netflix revenues are from international markets  
- Global impact of programs such as Squid Game, Stranger Things and KPop Demon Hunters
- How region specific programming shows growth potential

## Acquire the Data

```{r}
if (!dir.exists(file.path("data", "mp01"))) {
  dir.create(file.path("data", "mp01"), showWarnings = FALSE, recursive = TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if (!file.exists(GLOBAL_TOP_10_FILENAME)) {
  download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv",
    destfile = GLOBAL_TOP_10_FILENAME
  )
}

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

if (!file.exists(COUNTRY_TOP_10_FILENAME)) {
  download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv",
    destfile = COUNTRY_TOP_10_FILENAME
  )
}
```


```{r}
if (!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)
library(stringr)
library(DT)
```

## Data Import for the Global Top 10 dataset

```{r}
if (!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)

GLOBAL_TOP_10 <- read_tsv(GLOBAL_TOP_10_FILENAME)
```

Let's examine the structure of the dataset

```{r}
str(GLOBAL_TOP_10)
```

```{r}
glimpse(GLOBAL_TOP_10)
```

The dataset has 8,800 rows and 9 columns

By looking at the structure above, we do have some missing values not formatted as R would want it. Let's fix that issue

## Data Cleaning for the Global Top 10 dataset

```{r}
GLOBAL_TOP_10 <- GLOBAL_TOP_10 |>
  mutate(season_title = if_else(season_title == "N/A", NA, season_title))

str(GLOBAL_TOP_10)
```

Let's now confirm that the missing values are properly formatted for R.

```{r}
str(GLOBAL_TOP_10)
```
Great, let's turn to our second dataset that we will use. 

##  Data Import for the Country Top 10 dataset

```{r}
COUNTRY_TOP_10 <- read_tsv(COUNTRY_TOP_10_FILENAME, na = "N/A")


glimpse(COUNTRY_TOP_10)
```
We handle the missing values straight in the import phase in the `read_tsv`. We can see that missing values are format the way R wants it to.

After viewing the head and tail of the data, we want to just gain better sense of the data. For that let's chose a random number of rows other than the head or tail of the data by using the sample function to select random rows.
```{r}
GLOBAL_TOP_10[sample(nrow(GLOBAL_TOP_10), 10), ]
```

# Initial Data Exploration

```{r}
library(DT)
GLOBAL_TOP_10 |>
  head(n = 20) |>
  datatable(options = list(searching = FALSE, info = FALSE))
```

The column names such as `weekly_hours_viewed` are not properly formatted. Large numbers in that column are also not presented with commas.
Let's fix that!

```{r}
library(stringr)
format_titles <- function(df) {
  colnames(df) <- str_replace_all(colnames(df), "_", " ") |> str_to_title()
  df
}

GLOBAL_TOP_10 |>
  format_titles() |>
  head(n = 20) |>
  datatable(options = list(searching = FALSE, info = FALSE)) |>
  formatRound(c("Weekly Hours Viewed", "Weekly Views"))
```
We can now drop the `season_title` since here we are only showing films.

```{r}
GLOBAL_TOP_10 |>
  select(-season_title) |>
  format_titles() |>
  head(n = 20) |>
  datatable(options = list(searching = FALSE, info = FALSE)) |>
  formatRound(c("Weekly Hours Viewed", "Weekly Views"))
```
Finally, let's convert `Runtime` to minutes

```{r}
GLOBAL_TOP_10 |>
  mutate(`runtime_(minutes)` = round(60 * runtime)) |>
  select(
    -season_title,
    -runtime
  ) |>
  format_titles() |>
  head(n = 20) |>
  datatable(options = list(searching = FALSE, info = FALSE)) |>
  formatRound(c("Weekly Hours Viewed", "Weekly Views"))
```
Much better!

We are now ready for some Explanatory Data Analysis.

# EDA

**1. How many different countries does Netflix operate in?**

```{r, echo=FALSE}
countries <- COUNTRY_TOP_10 |>
  summarise(num_countries = n_distinct(country_name))
```
  
Netflix operates in *`r countries$num_countries`* countries.  

**2. Which non-English-language film has spent the most cumulative weeks in the global top 10?**
```{r}
top_non_english <- GLOBAL_TOP_10 |>
  filter(category == "Films (Non-English)") |>
  arrange(desc(cumulative_weeks_in_top_10)) |>
  slice(1) |>
  select(show_title, cumulative_weeks_in_top_10)

top_non_english
```

The non-English film with the most cumulative weeks in the global top 10 is *`r top_non_english$show_title`* with *`r top_non_english$cumulative_weeks_in_top_10`* weeks.


**3. What is the longest film (English or non-English) to have ever appeared in the Netflix global Top 10? How long is it in minutes?**
```{r}
longest_film_in_minutes <- GLOBAL_TOP_10 |>
  filter(category == "Films (English)" | category == "Films (Non-English)") |>
  arrange(desc(runtime)) |>
  slice(1) |>
  mutate(runtime_minutes = round(runtime * 60)) |>
  select(show_title, runtime_minutes)

longest_film_in_minutes
```

The longest film to have ever appeared in the Netflix global Top 10 is *`r longest_film_in_minutes$show_title`* with a runtime of *`r longest_film_in_minutes$runtime_minutes`* minutes.

**4.For each of the four categories, what program has the most total hours of global viewership?**

```{r}
most_viewed_program <- GLOBAL_TOP_10 |>
  group_by(category, show_title) |>
  summarise(total_hours_viewed = sum(weekly_hours_viewed, na.rm = TRUE), .groups = "drop") |>
  group_by(category) |>
  slice_max(total_hours_viewed) |>
  select(category, show_title, total_hours_viewed) |>
  format_titles() |>
  datatable(options = list(searching = FALSE, info = FALSE)) |>
  formatRound(c("Total Hours Viewed"))
most_viewed_program
```
**5. Which TV show had the longest run in a country’s Top 10? How long was this run and in what country did it occur?**

```{r}
longest_tv_run <- COUNTRY_TOP_10 |> 
  filter(category == "TV") |> 
  group_by(country_name, show_title) |> 
  summarise(longest_run = max(cumulative_weeks_in_top_10, na.rm = TRUE), .groups="drop") |> 
  slice_max(longest_run, n = 1, with_ties = TRUE) |> 
  format_titles() |> 
  datatable(options = list(searching = FALSE, info = FALSE))

longest_tv_run
```

The TV show with the longest run in a country's Top 10 is *`r longest_tv_run$show_title`* in *`r longest_tv_run$country_name`* with a total of *`r longest_tv_run$longest_run`* weeks.

**6.Netflix provides over 200 weeks of service history for all but one country in our data set. Which country is this and when did Netflix cease operations in that country?**

```{r}
dropped_country <- COUNTRY_TOP_10 |>
  group_by(country_name) |>
  summarise(max_week = max(week, na.rm = TRUE)) |>
  ungroup() |>
  arrange(max_week) |>
  slice(1)

dropped_country
```
The country where Netflix ceased operations the earliest is *`r dropped_country$country_name`* in the week of *`r dropped_country$max_week`*.

**7.What is the total viewership of the TV show Squid Game? Note that there are three seasons total and we are looking for the total number of hours watched across all seasons.**
```{r}
squid_game_viewership <- GLOBAL_TOP_10 |>
  filter(show_title == "Squid Game") |>
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE)) |>
  mutate(show_title = "Squid Game") |>
  select(show_title, total_hours)
squid_game_viewership
```
The total viewership of the TV show *Squid Game* across all seasons is `r scales::comma(squid_game_viewership$total_hours)` hours.



**8.The movie Red Notice has a runtime of 1 hour and 58 minutes. Approximately how many views did it receive in 2021? Note that Netflix does not provide the weekly_views values that far back in the past, but you can compute it yourself using the total view time and the runtime.**
```{r}
red_notice_views_2021 <- GLOBAL_TOP_10 |>
  filter(show_title == "Red Notice" & year(week) == 2021) |>
  summarise(total_views = sum(weekly_hours_viewed) / (1 + 58 / 60)) |>
  mutate(show_title = "Red Notice") |>
  select(show_title, total_views)

red_notice_views_2021
```
  
The movie Red Notice received approximately *`r scales::comma(red_notice_views_2021$total_views)`* views in 2021.
  
**9.How many Films reached Number 1 in the US but did not originally debut there? That is, find films that first appeared on the Top 10 chart at, e.g., Number 4 but then became more popular and eventually hit Number 1? What is the most recent film to pull this off?**

```{r, warning = FALSE}
library(dplyr)
library(stringr)

# Holder
us_films <- COUNTRY_TOP_10 |>
  filter(country_name == "United States", str_starts(category, "Films")) %>%
  select(show_title, week, weekly_rank)

debut <- us_films |>
  group_by(show_title) |>
  summarise(debut_week = min(week, na.rm = TRUE)) |>
  ungroup()

# get the ranks
films_us_number1 <- us_films |>
  group_by(show_title) |>
  summarise(
    best_rank   = min(weekly_rank, na.rm = TRUE),
    last_week_1 = max(week[weekly_rank == 1], na.rm = TRUE)
  ) |>
  ungroup() |>
  inner_join(debut, by = "show_title") |>
  left_join(us_films, by = c("show_title", "debut_week" = "week")) |>
  rename(debut_rank = weekly_rank) |>
  # different start but eventually hit # 1
  filter(!is.na(debut_rank), debut_rank > 1, best_rank == 1) |>
  arrange(desc(last_week_1)) |> 
  format_titles() |> 
  datatable(options = list(searching = FALSE, info = FALSE))

films_us_number1
```


**10. Which TV show/season hit the top 10 in the most countries in its debut week? In how many countries did it chart?**

```{r}
top_ten_debut <- COUNTRY_TOP_10 |>
  filter(category == "TV") |>
  group_by(show_title) |>
  filter(week == min(week)) |>
  summarise(countries = n_distinct(country_name)) |>
  ungroup() |>
  slice_max(countries, n = 1)

top_ten_debut
```

The TV show that hit the top 10 in the most countries was *`r top_ten_debut$show_title`* , and it charted in *`r top_ten_debut$countries`* countries.

# Press Releases


## Press Release 1: 

### Stranger Things: A Global Phenomenon Returns for Final Season

According to a 2025 Collider ranking, Season 4 of Stranger Things is widely regarded as the strongest of the first four seasons , this sets the tone for the highly anticipated final season arriving later this year. Stranger Things has really proven to be a truly global phenomenon. In the United States alone, it held a place in the Top 10 for 16 weeks, while internationally it achieved even greater staying power: 24 weeks in Ukraine, 23 weeks in Pakistan, 21 weeks in India, and more than a dozen weeks across European and African markets including Belgium, France, Kenya, and Nigeria. Compared to other popular English-language TV shows such as Wednesday and The Crown, Stranger Things remains one of Netflix’s most dominant hits. Globally it is surpassed only by the record-breaking Squid Game. With nearly 3 billion hours viewed worldwide, exictement for the last season is huge.

## Press Release 2:

### Netflix breakthrough in India

India is the world most populated country and has quickly become on of Netflix fastest growing market. TV shows and films in Hindi language continue their dominance in the country's top 10.Local TV and shows have stayed in the country's top 10 for numerous weeks. This prove the show broadest appeal to the domestic audience.
```{r echo=FALSE, message=FALSE, warning=FALSE}

india_hits <- COUNTRY_TOP_10 |>
  filter(country_name == "India", str_detect(category, "Films|TV")) |>
  group_by(show_title, category) |>
  summarise(weeks_in_top10 = n_distinct(week), .groups="drop") |>
  arrange(desc(weeks_in_top10))

usa_titles <-  COUNTRY_TOP_10 |>
  filter(country_name == "United States") |>
  distinct(show_title)

local_indian_hits <- india_hits |> 
  filter(!show_title %in% usa_titles$show_title) |> 
  format_titles() |> 
  datatable(options = list(searching = FALSE, info = FALSE))
         
local_indian_hits
```

"The Great Indian Kapil Show" remained in the India's Top 10 for 43 weeks, outperforming other international competitors. In the meantime ,several of the most successful domestic TV shows and Films have never appeared in the US Top 10, underscoring the value of programming specific to different regions in the world. With Netflix counting a lot on the success of international markets, India remains a key driver of the company's success at the international level.As Netflix continue to rely on international market, these results reaffirm the platform continued investment in India.

## Press Release 3

### Netflix Announces New Africa Originals Hub in Nigeria to Amplify Local Storytelling for Global Audiences

Nigeria, home to Africa’s largest film industry (Nollywood) and a booming youth demographic is at the center of a global creative renaissance. With more than 60% of its population under the age of 30, Nigeria represents one of the youngest, most dynamic entertainment markets in the world. This digitally savvy generation is driving rapid growth in streaming consumption, both within Africa and abroad.

In recent years, African productions such as Queen Sono (South Africa), Aníkúlápó (Nigeria), and Blood & Water (South Africa) have achieved strong engagement, demonstrating the rising demand for African storytelling. Viewership data shows that Netflix members outside Africa are increasingly turning to African films and series, with growth in hours viewed nearly doubling year-over-year.

“Our goal is simple: to help Africa’s incredible storytellers share their voices with the world,” said [Executive Name], Vice President of Content for EMEA at Netflix. “Nigeria’s young, creative, and connected population is shaping the future of global storytelling, and we are proud to be investing where the next wave of cultural influence begins.
This initiative underscores Netflix’s long-term commitment to Africa as both a source of creative innovation and a rapidly growing subscriber market, anchored by Nigeria’s youth-driven demand for authentic storytelling.

